
### å¼•ç”¨Referenceså‡ºç°çš„èƒŒæ™¯

æƒ³è¦è¯»å–ä¸€ä¸ªstring2æ¬¡ æŒ‰ownershipçš„æ–¹æ³•å°±æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦è°ƒç”¨çš„å‡½æ•°è¿”å›å€¼ å¹¶æ¥æ”¶è¿™ä¸ªå€¼ï¼Œæ‰€ä»¥æœ‰äº†å¼•ç”¨References

## **reference**Â æ˜¯Non-OwningæŒ‡é’ˆ

**reference**Â æ˜¯ä¸€ç§æ²¡æœ‰æ‰€æœ‰æƒçš„æŒ‡é’ˆ 

ä¸‹é¢è¿™ä¸ªå‡½æ•°ä¼šæŠ¥é”™ å› ä¸ºm1 m2ä¼šè¢«å‡½æ•°æ‰§è¡Œä¹‹åå›æ”¶

```rust
fn main() {
    let m1 = String::from("Hello");
    let m2 = String::from("world");
    greet(m1, m2);
    let s = format!("{} {}", m1, m2); // Error: m1 and m2 are moved
}

fn greet(g1: String, g2: String) {
    println!("{} {}!", g1, g2);
}
```

å¯ä»¥é€šè¿‡å‡½æ•°è¿”å›å€¼ï¼Œæˆ–è€…å¼•ç”¨çš„æ–¹å¼æ¥è§£å†³

å‡½æ•°è¿”å›å€¼ï¼š

```rust
fn main() {
    let m1 = String::from("Hello");
    let m2 = String::from("world");
    let (m1_again, m2_again) = greet(m1, m2);//è¿™é‡Œå¢åŠ äº†è¿”å›å€¼
    let s = format!("{} {}", m1_again, m2_again);
}

fn greet(g1: String, g2: String) -> (String, String) {
    println!("{} {}!", g1, g2);
    (g1, g2)
}
```

å¼•ç”¨

& æ“ä½œç¬¦å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯¹m1çš„å¼•ç”¨ï¼ˆæˆ–å«å€Ÿç”¨â€™borrowâ€™) é™¤äº†ä¼ å‚çš„æ—¶å€™ï¼Œåœ¨å‡½æ•°ç­¾åé‡Œé¢ï¼Œå‚æ•°çš„ç±»å‹æ³¨è§£ä¹Ÿæ”¹å˜äº† &Stringä»£è¡¨å¯¹Stringçš„å¼•ç”¨

m1æ‹¥æœ‰â€˜helloâ€™ï¼Œg1æ—¢ä¸æ‹¥æœ‰m1ä¹Ÿä¸æ‹¥æœ‰â€™helloâ€˜ã€‚greetå‡½æ•°æ‰§è¡Œå®Œåï¼Œåªæœ‰greetåœ¨æ ˆä¸­çš„frameæ²¡æœ‰äº† å…¶ä»–éƒ½ä¸å˜ è¿™ä¹Ÿéµå¾ªäº†ç›’å­é‡Šæ”¾åŸåˆ™ï¼Œå› ä¸ºg1ä¸æ˜¯â€™Helloâ€™çš„æ‹¥æœ‰è€…

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled.png)

**reference**Â æ˜¯Non-OwningæŒ‡é’ˆï¼Œå› ä¸ºå®ƒä»¬ä¸æ‹¥æœ‰å®ƒä»¬æ‰€æŒ‡å‘çš„æ•°æ®

## å–æ¶ˆå¼•ç”¨æŒ‡é’ˆ

**å–æ¶ˆå¼•ç”¨ä½¿ç”¨ * æ“ä½œç¬¦**

```rust
let mut x: Box<i32> = Box::new(1);
let a: i32 = *x;         // *x ç›´æ¥è¯»å– heapå€¼ï¼Œæ‰€ä»¥aç­‰äº1
*x += 1;                 // *x æ”¹å˜äº† heap å€¼,
                         //    æ‰€ä»¥xä¼šæŒ‡å‘2

let r2: &i32 = &*x;      // r2 ç›´æ¥æŒ‡å‘heapçš„å€¼;
```

æ³¨æ„ï¼šè¿™é‡Œxæ˜¯è¢«èµ‹å€¼äº†Box::new(1);ï¼Œ è€Œä¸æ˜¯1ï¼Œæ‰€ä»¥ä¼šåœ¨heapé‡Œé¢åˆ›å»ºä¸€ä¸ªBoxï¼Œå¦‚æœæ˜¯1,å°±æ˜¯åœ¨stacké‡Œé¢ï¼Œåƒaä¸€æ ·

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%201.png)

å†æ¥çœ‹ä¸€ç§æƒ…å†µï¼š

```rust
fn main() {
    let mut point = [0, 1];
    let mut x = point[0]; 
    let y = &mut point[1]; 
    x += 1; 
    *y += 1; 
    println!("{} {}", point[0], point[1]);
}
```

è¿™é‡Œçš„point[0], point[1]åˆ†åˆ«ä¼šæ‰“å°ä»€ä¹ˆï¼ŸğŸ˜¯

ç­”æ¡ˆæ˜¯0,2

```rust
fn main() {
    let mut point = [0, 1];
    let mut x = point[0];//xæ˜¯å¯¹point[0]çš„å¤åˆ¶
    let y = &mut point[1];//yæ˜¯å¯å˜å¼•ç”¨
    x += 1;//æ”¹å˜xä¸ä¼šå½±å“æŒ‡é’ˆ 
    *y += 1;//æ”¹å˜yä¼šæ”¹å˜æŒ‡é’ˆ
    println!("{} {}", point[0], point[1]);
}
```

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%202.png)

**å–æ¶ˆå¼•ç”¨æœ‰æ˜¾å¼å’Œéšå¼**

```rust
let x: Box<i32> = Box::new(-1);
let x_abs1 = i32::abs(*x); // explicit dereference i32::abså‡½æ•°æœŸæœ›ä¸€ä¸ªi32ç±»å‹çš„è¾“å…¥ æ‰€ä»¥å¯ä»¥åƒè¿™æ ·æ˜¾å¼å–æ¶ˆå¼•ç”¨
let x_abs2 = x.abs();      // implicit dereference è¿™ç§å†™æ³•æ˜¯ä¸Šé¢é‚£ç§å‡½æ•°è°ƒç”¨å†™æ³•çš„è¯­æ³•ç³–ï¼Œä¸è¿‡æ˜¯éšå¼å–æ¶ˆå¼•ç”¨
```

å¼•ç”¨ä¹Ÿæœ‰æ˜¾å¼å’Œéšå¼

```rust
let s = String::from("Hello");
let s_len1 = str::len(&s); // explicit reference æ˜¾å¼å¼•ç”¨
let s_len2 = s.len();      // implicit referenceè°ƒç”¨åœ¨Stringä¸Šçš„len
assert_eq!(s_len1, s_len2);
```

## Rustä¼šé¿å…åŒæ—¶å‡ºç°Aliasingå’ŒMutation

æŒ‡é’ˆä¼šå¯¼è‡´aliasingã€‚

aliasingï¼šé€šè¿‡ä¸åŒçš„å˜é‡è®¿é—®ç›¸åŒçš„æ•°æ®

å‘é‡æ•°æ®ç»“æ„ï¼šVecï¼Œé•¿åº¦æ˜¯å¯å˜çš„

```rust
let mut v: Vec<i32> = vec![1, 2, 3];//<i32>è¡¨ç¤ºvectorä¸­çš„å…ƒç´ éƒ½æ˜¯i32ç±»å‹
v.push(4);
```

vå˜é‡æœ‰ä¸€å®šçš„å®¹é‡å»åˆ†é…heapæ•°ç»„ï¼Œè¿™é‡Œvå˜é‡é•¿åº¦ä¸º3 å®¹é‡capacityä¹Ÿæ˜¯3

åœ¨v.push(4);ä¹‹åï¼Œvè¦æ‰©å®¹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å†…å­˜ï¼Œä¼šé‡Šæ”¾æ‰åŸæ¥çš„heapæ•°ç»„ï¼Œå°±æ˜¯ã€1,2,3ã€‘

```rust
let mut v: Vec<i32> = vec![1, 2, 3];
let num: &i32 = &v[2];
v.push(4);
println!("Third element is {}", *num);//æŠ¥é”™ å› ä¸ºv.push(4);ä¹‹åé‡Šæ”¾äº†numæŒ‡å‘vec
```

æŠ½è±¡åœ°è®²ï¼Œè¿™ç§æŠ¥é”™å°±æ˜¯å› ä¸º våŒæ—¶è¢«åˆ«åï¼ˆè¢«numå¼•ç”¨ï¼‰å’Œè¢«æ”¹å˜mutated(v.push(4);) 

æŒ‡é’ˆå®‰å…¨åŸåˆ™ï¼šæ•°æ®ä¸èƒ½**åŒæ—¶**è¢«åˆ«åå’Œæ”¹å˜

## å¼•ç”¨å¯ä»¥é€šè¿‡pathæ”¹å˜æƒé™

å€Ÿç”¨æ£€æŸ¥å™¨çš„æ ¸å¿ƒè¦ç‚¹æ˜¯å˜é‡å¯¹æ•°æ®æœ‰3ç§æƒé™

- è¯»å–R  å°†æ•°æ®å¤åˆ¶åˆ°å…¶ä»–ä½ç½®
- å†™å…¥W æ•°æ®å¯ä»¥å°±åœ°æ”¹å˜
- æ‹¥æœ‰O æ•°æ®å¯ä»¥è¢«ç§»åŠ¨æˆ–åˆ é™¤

è¿™äº›æƒé™åªåœ¨ç¼–è¯‘å™¨ä¸­å­˜åœ¨ åœ¨è¿è¡Œæ—¶ä¸å­˜åœ¨

é»˜è®¤ï¼Œå˜é‡æœ‰è¯»å–å’Œæ‹¥æœ‰çš„æƒåˆ©ï¼Œå¦‚æœå˜é‡æ˜¯é€šè¿‡let mutå£°æ˜çš„ï¼Œå°±æœ‰å†™çš„æƒåˆ©ã€‚**å¼•ç”¨å¯ä»¥æš‚æ—¶ç§»é™¤è¿™äº›æƒåˆ©**

æ³¨æ„ï¼šè¿™é‡Œ&v[2]ç§»èµ°äº†vçš„Wå’ŒOï¼Œåªè¦æ˜¯å€Ÿç”¨å°±ä¼šç§»èµ°åŸæ¥å˜é‡çš„æ‹¥æœ‰æƒå’Œå†™å…¥ 

```rust
let mut v: Vec<i32> = vec![1, 2, 3];//v: R W O
let num: &i32 = &v[2];//v: R num: O R å› ä¸ºnumä¸æ˜¯é€šè¿‡let mutæ¥å£°æ˜çš„ æ‰€ä»¥æ²¡æœ‰write
println!("Third element is {}", *num);//æ‰“å°ä¹‹å numå°±æ²¡æœ‰äº†Oå’ŒR vé‡æ–°è·å¾—W O ï¼Œv:W R O
//println!("Third element is {}", *num);//å¦‚æœåé¢è¿˜æœ‰ä½¿ç”¨*num å°±åœ¨è¿™é‡Œnumå†å¤±å»æƒåˆ©
v.push(4);//væ²¡æœ‰äº†æ‰€æœ‰æƒé™
```

ä¸ºä»€ä¹ˆä¼šåŒæ—¶çœ‹åˆ°numå’Œ *num

é€šè¿‡å¼•ç”¨è®¿é—®æ•°æ®å’Œæ“ä½œå¼•ç”¨æ˜¯ä¸åŒçš„

```rust
let x =0;//x: R O
let mut x_ref = &x;//x:R,
//x_refå€Ÿç”¨äº†xæ‰€ä»¥æœ‰äº†R O,åˆå› ä¸ºå®ƒæ˜¯é€šè¿‡let mutå®šä¹‰çš„ï¼Œæ‰€ä»¥æœ‰äº†Wï¼Œx_ref:R W O , *x_ref:R
//è¿™æ ·å†æ¬¡ç»™x_refèµ‹å€¼å°±å¯ä»¥ ä½†æ˜¯ä¸èƒ½æ”¹å˜*x_refçš„å€¼ 
```

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%203.png)

x_refæœ‰å†™å…¥æƒé™ï¼Œæ‰€ä»¥å¯ä»¥x_ref=&y

*x_refæ²¡æœ‰å†™å…¥æƒé™ï¼Œæ‰€ä»¥ä¸èƒ½è¢«ä¿®æ”¹ *x_ref+=1æ˜¯ä¸è¡Œçš„

**pathçš„å®šä¹‰**

æƒé™æ˜¯åœ¨pathä¸Šå®šä¹‰çš„ï¼Œè€Œä¸ä»…ä»…æ˜¯å˜é‡ï¼Œä¸€ä¸ªpathæ˜¯ä»»ä½•å¯ä»¥æ”¾åœ¨è¡¨è¾¾å¼å·¦ä¾§çš„ä¸œè¥¿ï¼Œå®ƒåŒ…å«

1. å˜é‡ a
2. å¯¹è·¯å¾„å–æ¶ˆå¼•ç”¨ *a
3. æ•°ç»„è®¿é—® a[0]
4. è·¯å¾„çš„field æ¯”å¦‚tupleç±»å‹çš„a.0æˆ–è€…structç±»å‹çš„a.field
5. ä¸Šé¢æåˆ°çš„é¡¹çš„ç»„åˆï¼Œæ¯”å¦‚ *((*a)[0].1)

## å€Ÿç”¨æ£€æµ‹å™¨å‘ç°æƒé™å†²çª

åˆ›å»ºå¯¹è±¡æ•°æ®çš„å¼•ç”¨&å°±æ˜¯å€Ÿç”¨borrowã€‚è¿™é‡Œnumå¯¹vçš„å¼•ç”¨ä¼šå¯¼è‡´væš‚æ—¶ä¸ºåªè¯»ï¼Œç›´åˆ°ä¸å†ä½¿ç”¨numã€‚

Rustä½¿ç”¨å€Ÿç”¨æ£€æµ‹å™¨æ¥æ£€æŸ¥æ½œåœ¨çš„ä¸å®‰å…¨å¼•ç”¨æ“ä½œ

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%204.png)

ruståœ¨ä½¿ç”¨pathçš„æ—¶å€™ï¼Œä¼šæ ¹æ®å¯¹å˜é‡çš„æ“ä½œæ˜¾ç¤ºå˜é‡åº”è¯¥è¦æœ‰çš„å±æ€§

è¿™é‡Œ&v[2]çš„æ—¶å€™éœ€è¦væ˜¯å¯è¯»çš„ æ‰€ä»¥Rå°±æ˜¾ç¤ºäº†

è€Œv.push(4)çš„æ—¶å€™ éœ€è¦væ˜¯å¯è¯»è€Œä¸”å¯ä»¥å†™å…¥çš„ æ‰€ä»¥Rå’ŒWéƒ½æ˜¾ç¤ºäº† ä½†æ˜¯æ­¤æ—¶væ²¡æœ‰Wå±æ€§ æ‰€ä»¥Wæ˜¯é•‚ç©ºçš„ï¼Œè¿™æ ·ç¼–è¯‘å°±ä¼šæŠ¥é”™

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%205.png)

æŠ¥é”™æ˜¾ç¤ºvä¸èƒ½è¢«æ”¹å˜ å› ä¸ºreference:numè¿˜åœ¨ä½¿ç”¨ï¼Œpushä¹‹ånumå°±æ— æ•ˆäº†

## å¯å˜å¼•ç”¨æä¾›äº†å¯¹æ•°æ®å•ä¸€ä¸”ä¸æ‹¥æœ‰çš„æƒé™

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%206.png)

numé€šè¿‡&mutå˜æˆäº†ä¸€ä¸ªå¯å˜çš„å¼•ç”¨ã€‚è¿™å’Œä¹‹å‰çš„åŒºåˆ«ï¼š

1. numæ˜¯ä¸å¯å˜çš„æ—¶å€™,vè¿˜æœ‰Rè¯»å–çš„æƒé™ï¼Œç°åœ¨numæ˜¯ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œåªè¦numè¿˜åœ¨è¢«ç”¨ï¼Œvå°±ä»€ä¹ˆæƒé™éƒ½æ²¡æœ‰äº†ï¼Œè¿™å°±éµå¾ªäº†å¼•ç”¨å®‰å…¨åŸåˆ™ï¼Œvæš‚æ—¶æ˜¯ä¸å¯ç”¨çš„ï¼Œæ‰€ä»¥å°±ä¸æ„æˆåˆ«å
2. numæ˜¯ä¸å¯å˜çš„æ—¶å€™ï¼Œ*numåªæœ‰Rè¯»å–æƒé™ï¼Œç°åœ¨numæ˜¯ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œ*numä¹Ÿè·å¾—äº†Wå†™å…¥æƒé™ï¼Œv[2]å¯ä»¥é€šè¿‡*numè¢«æ”¹å˜ï¼Œ*num+=1å°±æ”¹å˜äº†v[2]ã€‚ä½†æ˜¯numæ²¡æœ‰Wå†™å…¥æƒé™ï¼Œå› ä¸ºnumæŒ‡å‘äº†è¿™ä¸ªå¯å˜å¼•ç”¨æœ¬èº«ï¼Œæ‰€ä»¥numä¸èƒ½è¢«å†æ¬¡èµ‹å€¼

å¯å˜çš„å¼•ç”¨ä¹Ÿå¯ä»¥æš‚æ—¶è¢«å˜æˆåªè¯»çš„å¼•ç”¨

åœ¨è¿™é‡Œæ˜¯é€šè¿‡ &*numç§»èµ°äº†*numçš„Wæƒé™

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%207.png)

## æƒé™åœ¨å¼•ç”¨çš„ç”Ÿå­˜å‘¨æœŸç»“æŸåè¿”å›

ç”Ÿå­˜å‘¨æœŸï¼šå¼•ç”¨åˆ›å»º-å¼•ç”¨æœ€åä¸€æ¬¡è¢«ä½¿ç”¨

åœ¨let z= *y ä¹‹å yçš„Wæƒé™ä¼šè¿”å›ç»™x 

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%208.png)

åœ¨ä¸åŒçš„ifåˆ†æ”¯é‡Œé¢ cæœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨thenåˆ†æ”¯é‡Œé¢ï¼Œ*vå¾—åˆ°c.to_ascii_uppercase()æ‰§è¡Œå®Œä¹‹åæ‰é‡æ–°è·å¾—Wæƒé™ï¼Œåœ¨elseåˆ†æ”¯é‡Œé¢ï¼Œ*vä¸€è¿›å…¥elseåˆ†æ”¯å°±å¾—åˆ°Wæƒé™

![Untitled](References%20and%20Borrowing%2053e01dc9ba774f7ab88202055ac484e7/Untitled%209.png)

```rust
fn get_first(v: &Vec<String>) -> &str {
    &v[0]
}

fn main() {
    let mut strs = vec![
        String::from("A"), String::from("B")
    ];
    let first = get_first(&strs);//é€šè¿‡get_firstå¼•ç”¨&strs æ‰€ä»¥firstå€Ÿç”¨äº†&strs
    if first.len() > 0 {
        strs.push(String::from("C"));
    }
}
```

## æ•°æ®å¿…é¡»æ¯”å…¶æ‰€æœ‰å¼•ç”¨éƒ½æ›´æŒä¹…

rustä½¿ç”¨2ç§æ–¹å¼ç¡®ä¿æ•°æ®æ¯”å…¶æ‰€æœ‰åº”ç”¨æ›´æŒä¹…ï¼š

1. å¤„ç†åœ¨ä¸€ä¸ªä½œç”¨åŸŸå†…åˆ›å»ºå’Œåˆ é™¤çš„å¼•ç”¨

rustçŸ¥é“æ™®é€šå¼•ç”¨èƒ½å­˜æ´»å¤šä¹… ä½†æ˜¯å¯¹äºå±äºå‡½æ•°è¾“å…¥æˆ–è€…å‡½æ•°è¾“å‡ºçš„å¼•ç”¨ rustéœ€è¦ä¸€ä¸ªä¸åŒçš„æœºåˆ¶ 

1. ä½¿ç”¨æµæƒé™

Fæ˜¯æµæƒé™(Flow permission) å½“ä¸€ä¸ªè¡¨è¾¾å¼ä½¿ç”¨äº†è¾“å…¥å¼•ç”¨æˆ–è€…è¿”å›äº†ä¸€ä¸ªè¾“å‡ºå¼•ç”¨ï¼Œå°±éœ€è¦æµæƒé™

```rust
fn first(strings: &Vec<String>) -> &String {
    let s_ref = &strings[0];//è¾“å…¥å¼•ç”¨
    s_ref//è¿”å›è¾“å‡ºå¼•ç”¨
}
```

ä¸åƒRWOï¼ŒFåœ¨æ•´ä¸ªå‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰æ”¹å˜ã€‚ä¸€ä¸ªå¼•ç”¨å¦‚æœå…è®¸è¢«ä½¿ç”¨å°±æœ‰Fæƒé™ï¼š

è¿™æ®µä»£ç ä¸ä¼šç¼–è¯‘ æŠ¥é”™**missing lifetime specifier**

```rust
fn first_or(strings: &Vec<String>, default: &String) -> &String {
    if strings.len() > 0 {
        &strings[0]//æ²¡æœ‰æµæƒé™
    } else {
        default//æ²¡æœ‰æµæƒé™
    }
}
```

å¦‚æœruståªçœ‹å‡½æ•°ç­¾åï¼Œå°±ä¸çŸ¥é“è¾“å‡ºçš„&Stringæ˜¯å¯¹stringsçš„å¼•ç”¨è¿˜æ˜¯defaultçš„å¼•ç”¨ 

å¦‚æœåƒä¸‹é¢è¿™æ ·å­ä½¿ç”¨first_orå‡½æ•° ä»£ç ä¸ä¼šè¢«ç¼–è¯‘,å› ä¸ºrustéœ€è¦ç¡®å®šdefaultå˜é‡ä¸ä¼šè¢«æµåˆ°è¿”å›å€¼ã€‚å› ä¸ºå¦‚æœdefaultæ˜¯è¿”å›å€¼çš„ä¸€éƒ¨åˆ†æˆ–è€…æ˜¯è¿”å›å€¼ï¼Œdropä¼šå¯¼è‡´sæ— æ•ˆ ä¸ºäº†æŒ‡å®šdefaultèƒ½ä¸èƒ½è¢«è¿”å›ï¼Œrustæä¾›äº†lifetime parametersã€‚ï¼ˆåœ¨ç¬¬10ç« ï¼‰ç°åœ¨åªéœ€çŸ¥é“ï¼š

1. input/outputå¼•ç”¨åœ¨å‡½æ•°ä½“ä¸­å’Œæ™®é€šå¼•ç”¨æ˜¯ä¸ä¸€æ ·çš„
2. rustä½¿ç”¨äº†æµæ§åˆ¶Fæ¥æ£€æŸ¥input/outputå¼•ç”¨çš„å®‰å…¨

```rust
fn main() {
    let strings = vec![];
    let default = String::from("default");
    let s = first_or(&strings, &default);
    drop(default);
    println!("{}", s);
}
```

æµ‹è¯•é¢˜ç›®ï¼š

è¿™æ®µä»£ç ä¼šè¢«ç¼–è¯‘å—ï¼Ÿä¸ºä»€ä¹ˆ

```rust

fn incr(n: &mut i32) {
  *n += 1;
}
fn main() {
  let mut n = 1;
  incr(&n);
  println!("{n}");
}
```

è¿™æ®µä»£ç ä¸ä¼šè¢«ç¼–è¯‘ å› ä¸ºnæ˜¯ä¸€ä¸ªmut æ‰€ä»¥å¯¹å®ƒçš„å¼•ç”¨ä¹Ÿå¾—æ˜¯mut incr(&mut n)

```rust

fn main() {
  let mut s = String::from("hello");
  let s2 = &s;
  let s3 = &mut s;
  s3.push_str(" world");
  println!("{s2}");//å½“ä¸å¯å˜çš„s2è¿˜æ´»è·ƒçš„æ—¶å€™ å°±ä½¿ç”¨mut sç»™åˆ°s3æ˜¯ä¸è¢«å…è®¸çš„
}
```

## Summary

å¼•ç”¨æä¾›äº†ä¸€ç§æ— éœ€æ‰€æœ‰æƒçš„æ•°æ®è¯»å–å’Œå†™å…¥æ–¹å¼ 

å¼•ç”¨æ˜¯é€šè¿‡borrows(&å’Œ&mut)è¿˜æœ‰å–æ¶ˆå¼•ç”¨(*)åˆ›å»ºçš„ï¼Œé€šå¸¸æ˜¯éšå¼åˆ›å»º

Rustä½¿ç”¨å€Ÿç”¨æ£€æµ‹å™¨æ¥ç¡®ä¿å¼•ç”¨è¢«å®‰å…¨ä½¿ç”¨ï¼š

1. æ‰€æœ‰çš„å˜é‡éƒ½å¯ä»¥è¯»å– æ‹¥æœ‰ å†™å…¥æ•°æ®(optionally)
2. åˆ›å»ºä¸€ä¸ªå¼•ç”¨ä¼šå°†æƒé™ä»borrowed pathè½¬ç§»åˆ°å¼•ç”¨
3. ä¸€æ—¦å¼•ç”¨çš„lifetimeç»“æŸ æƒé™å°±ä¼šè¿”å›
4. æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸå¿…é¡»æ¯”æ‰€æœ‰æŒ‡å‘å®ƒçš„å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸé•¿

å‚è€ƒï¼š
https://rust-book.cs.brown.edu/